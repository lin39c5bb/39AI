user name: fossilsditchcursesspells 
work link: https://discord.com/channels/1134557553011998840/1373556923710046241
description: for gemini（大概？）

原文：
# 首先，别问第三方渠道问题
# 类脑萌新的自用预设，自己玩着感觉很不错所以分享出来，理论支持vertex，但效果不好的话轻喷T T
# 注意：在插头处把提示词后处理设置成合并连续角色相同的发言
女性向文风自己没测试过很多楼，不好用的话可以自己缝进来
最新预设和正则：https://discord.com/channels/1134557553011998840/1373556923710046241/1388810177981190208
# 请搭配预设配套的脚本使用用于维护重要元素：https://discord.com/channels/1134557553011998840/1373556923710046241/1374239606555283497
除了“切换角色卡时一键补全历史标签”似乎没用之外暂时没发现bug了，检测到AI回复DR标记错误或者漏回时会自动修改或添加。
注意：请确保你的酒馆对话楼层数是严格按照一条用户消息一条ai回复消息的交替情况，不要出现如下的情况：
```
<你的消息>
<你的消息>
<AI回复的消息>
```
如果再出现bug，及时反馈给我，如果此脚本还会对您的角色卡聊天记录造成损害请允许我诚挚道歉orz😭 酒馆的自动备份记录在：...\SillyTavern\data\(用户名)\backups
如果很怕自动修复脚本把文件给杀了，请找到`// 初始延迟`前的数值改为5000（这样有5秒初始化时间）或更长

# 在预设编写时参考了以下大佬的帖子/思路，感谢无私奉献（排名不分先后）：
https://discord.com/channels/1134557553011998840/1311176004634542110
https://discord.com/channels/1134557553011998840/1359169909807907006
https://discord.com/channels/1134557553011998840/1300131442432409772
https://discord.com/channels/1134557553011998840/1326118124038393856
https://discord.com/channels/1291925535324110879/1359953654056222911
说一下我个人的看法，从两个月前入坑什么都不懂的小白到现在用上了自己的预设，以上的帖子不管是在酒馆使用还是编写自己的提示词上都真的帮助了我很多，而这些理解难度基本与教程无益的优质帖子通常隐没在很深的位置，我觉得真的很可惜，建议大家都去看看
摘要的格式和思路来源于【Lyean预设】https://discord.com/channels/1134557553011998840/1274681338556846101
编写时还参考了：Google官方的提示工程白皮书
Silly Tavern官方说明文档

破限力度是足够的

🧠CoT使用详解：
当你决定启用CoT后：
必开部分：
- CoT的开始和结束部分
- Step1、2、3、7、8、9、11（实际上789三部分也不一定属于“必开”，但它们三个会互相强化）这些属于基础部分

自定义部分：
-Step6、10：玩前端、启用了情绪调控系统时必开，有效防止掉格式。
- Step4、5：开了情绪调控系统时开启你选用的模块的对应的CoT。其中Step5的长短程就不用说了，长的tk大、响应慢，效果好；短的tk少、响应不一定快、效果不一定不好
Step6 ：自定义部分，如果你在预设里加入了其他功能性模块，可在此部分编写对应CoT
必开正则（在默认使用预设自带的摘要情况下）https://discord.com/channels/1134557553011998840/1373556923710046241/1388810177981190208
# 最新预设指路：https://discord.com/channels/1134557553011998840/1373556923710046241/1388810177981190208
1.找到酒馆的“高级格式化设置”（酒馆顶栏的“A”），然后：
- 关闭“指导模板”与“系统提示词”
- 找到“推理”部分，仅勾选“自动解析”，点开“推理内容格式化”的小三角，将“前缀”改为thinking，后缀置空（什么也别填）（这一步有什么作用我也不太确定🤣🤣，配合卡CoT的提示词好像会提升一点出字速度）

将插头的提示词后处理改为合并相同角色连续的发言

！！！放在最前面： 请一定保持卡CoT开启，本预设的卡CoT能百分百卡掉原生思维链！检查启用的所有世界书中是否自带cot，如果有，请关闭！或者你愿意搞的话，把cot发我，我教你！

2.基本注意事项与标签说明：
🔴标签：
- 语言选项在“🦾核心创作要求概述”中修改。
- 篇幅长度在“🟡长/短回复模式”中修改。
- 🔴标记的部分是不可或缺的，默认情况下，🔴标签应该打开了：
1.  “🔴前置破限”
2.“🔴别关别动|⏲时间管理机制模块”
3.“🔴别动别关：回合强调”，
4. “🔴最新回合开始”


注意：🔴实验性防截断必然也会对模型智力造成影响，它就像是杀虫剂，只要是“虫子”（大模型）就会受到影响，原理就是让比我们用的模型更小脑更弱智的模型的脑子转不过来。

🚫部分意思是：不要破坏<chat>...chathistory...</chat>的结构，“以深度插入”的提示词与世界书内容当然是允许的，但不要在d0层级放太多内容、复杂内容！！最好也不要在“🚫别关别动别在它和chat history里加任何内容（下）”和““🔴最新回合开始””中插入任何内容！

🔵标签：
- 🔵标记的部分通常是可并行开启的，但需要理性看待大模型的能力，平衡自己的需求。注意：战斗文风通常在RP中极少出现，所以完全可以等到需要战斗场面刻画时再开启；同理，如果玩的卡不是一直都在色色，那么情色文风也不必一直开着。其余文风可自行插入，也应该插入“📜文风定义开始”与“📜文风定义结束”之间，仅储存在世界书中的文风可能影响力很小。

🟢标签：
- 🟢标记的部分通常是必须开启的，主要是保持结构的作用。

🟡标签：
- 🟡标记的部分，如果在同一结构下，通常是互斥的或者共同开启时效果不好的，请选择其一开启。
- 本预设的角色情绪调控系统是特色但也属于测试中功能，占用token大、响应时间长，但输出无误时很好用。

3.⚠️重要说明⚠️：
- 再次强调：请一定保持卡CoT开启！

- 请保持本预设的CoT部分保持开启并一定在使用前检查，不要启用任何其他世界书中的CoT，预设自带的CoT十分重要且效力足够，如果需要用其他CoT请自行编辑并插入CoT部分的合理位置（Step6中）！！如果不会，请在预设帖下反馈并让我帮你修改！

-  现在取消了“不输出思维链版”，因为展现思维链非常重要！

- 不建议隐藏回复前的`[DR_n]`标签，这是时间流逝的重要指标，并且本身并不长所以对观感影响不大

- **请时刻注意模型回复有没有产生错误！基于上下文特征，如果前文出现错误那么后续的回复中出现同样错误的概率会不断上升！本预设能够防止正文中出现星号增殖的情况，但诸如省略号增殖的情况仍可能发生**


 license：本作品采用 [CC BY-NC-ND 4.0](https://creativecommons.org/licenses/by-nc-nd/4.0/) 协议共享。
